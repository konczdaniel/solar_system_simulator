{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Solar Simulator">
    <link rel="stylesheet" href="{% static 'project1/styles/solar.css'%}?v=2">
    <link rel="stylesheet" href="{% static 'project1/styles/register.css' %}">
    <link rel="icon" type="image/x-icon" href="{% static 'project1/images/favicon.ico' %}">
    <title>Document</title>

</head>
<body>
    <div class="header">
        <div class="header-left">
            <div class="upper-content">Hi,{{name}}!</div>
            <div class="down-content">
                <div style="display: flex; flex-direction: row;justify-content: center;align-items: center;">
                    <div class="online-circle"></div>
                    <div class="online">Online</div>
                    <div style="color:rgba(51, 51, 51, .6); font-weight: 600;">Inverter</div>
                    <div style="font-weight: 600; margin-left:5px">{{house_invertor}}W</div>
                </div>
            </div>
        </div>
        <div class="logout">
            <a href="{% url 'logout' %}" class="logout-button">Logout</a>
        </div>
    </div>
    <div class="main-box">
        <div class="solar-box">
            <div class="upper-box">
                <div>Flow Graph</div>
                <div style="margin-right: 10px;"">Plant Data&#9662;</div>
            </div>
            <!-- Upper solar section -->
            <div class="solar-upper">
                <div class="sollar-inner-box" style="height: 100%;">
                    <div class="solar-image-border">
                        <img alt="solar" src="{% static 'project1/images/flow-up-white.svg' %}">
                    </div>
                    <div style="display: flex; flex-direction: row;font-weight: 600;">
                        <div id="solar-output">{{solar_value}}</div>
                        W
                    </div>
                </div>
                <div class="sollar-inner-box">
                    <div class="solar-image-border">
                        <img alt="grid" src="{% static 'project1/images/flow-grid-white.svg' %}">
                    </div>
                    <div style="font-weight: 600; display: flex; flex-direction: row;">
                        <div id="grid-output">20</div>
                        W
                    </div> <!-- completare data dinamic -->
                    <div id="grid-status"></div>
                </div>
            </div>
            <!-- Middle section -->
            <div class="solar-middle">
                <div class="sollar-inner-box">
                    <div class="solar-image-border">
                        <img alt="inverter" src="{% static 'project1/images/flow-inverter-white.svg' %}" style="width: auto; height: auto;">
                    </div>
                    <div style="font-weight: 600;">Invertor</div> <!-- completare data dinamic -->
                </div>
                <!-- Dotted lines Up Left-->
                <div class="dotted-horizontal-middle-up">
                    <div class="dotted-vertical-up-left">
                        <div class="left-up-vertical"><div id="bila1"></div></div> <!--bila1 -->
                    </div>
                </div>
                <!-- Dotted lines Up Right -->
                <div class="one-right-up">
                    <div class="two-right-up">
                        <div class="three-right-up"><div id="bila2"></div></div>
                    </div>
                </div>
                <!-- Dotted lines Down Left -->
                <div class="one-left-down">
                    <div id="bila3-charge"></div>
                    <div class="two-left-down">
                        <div class="three-left-down"><div id="bila3-discharge"></div></div>
                    </div>
                </div>
                <!-- Dotted lines Down Right -->
                <div class="one-right-down">
                    <div id="bila4"></div>
                    <div class="two-right-down">
                        <div class="three-right-down"></div>
                    </div>
                </div>
            </div>
            <!-- Lower section -->
            <div class="solar-upper" style="padding:0px; padding-bottom: 20px;">
                 <div class="sollar-inner-box">
                    <div class="solar-image-border">
                        <div class="battery-procent">
                            <div id="battery-procent">
                                {{battery_percent}}
                            </div>
                            %
                        </div>
                        <img alt="battery" src="{% static 'project1/images/flow-battery-50.svg' %}" style="width: auto; height: auto;padding:4px;">
                    </div>
                    <div style="display: flex; flex-direction: row; align-items: center; justify-content: center;font-weight: 600;">
                        <div id="battery-value">{{battery}}</div> <!-- completare data dinamic -->
                        W
                    </div>
                </div>
                <div class="sollar-inner-box">
                    <div class="solar-image-border">
                        <img alt="load" src="{% static 'project1/images/flow-use-white.svg' %}" style="width: auto; height: auto;">
                    </div>
                    <div style="display: flex;flex-direction: row; font-weight: 600;">
                        <div id="valueOutput">{{load}}</div> <!-- completare data dinamic -->
                        W
                    </div>
                </div>
            </div>
        </div>
        <div class="solar-box">
            <div class="upper-box" style="margin-bottom: 20px;">
                <div style="display: flex; align-items: center; justify-content: center;">Grid Status</div>
                <button type="checkbox" id="grid-on-off">On/Off</button>
            </div>
            <div class="upper-box" style="margin-bottom: 20px;">
                <div>House Load</div>
                <div style="display: flex; flex-direction: row;">
                    <label for="myRange">0</label>
                    <input type="range" id="myRange" min="0" max="{{house_invertor}}" value="{{load}}">
                    <div>{{house_invertor}}</div>
                </div>
            </div>
            <div class="upper-box">
                <div>Max Solar Production</div>
                <div style="display: flex; flex-direction: row;">
                    <label for="solar-slider">0</label>
                    <input type="range" id="solar-slider" min="0" max="{{solar_power}}" value="{{solar_value}}">
                    <div>{{solar_power}}</div>
                </div>
            </div>
        </div>
        <div class="solar-box">
            <div class="upper-box" style="margin-bottom: 20px;">
                <div style="font-weight: 600; display: flex;justify-content: center;align-items: center;">My Configuration</div>
                <button class="edit-conf-button" id="openPopup">Edit</button>
            </div>
            <div class="upper-box" style="margin-bottom: 20px;">
                <div style="display: flex;align-items: center;justify-content: center;">Invertor Capacity</div>
                <div class="configuration-values">{{house_invertor}}</div>
            </div>
            <div class="upper-box" style="margin-bottom: 20px;">
                <div style="display: flex;align-items: center;justify-content: center;">Instaled solar Power</div>
                <div class="configuration-values">{{solar_power}}</div>
            </div>
            <div class="upper-box" style="margin-bottom: 20px;">
                <div style="display: flex;align-items: center;justify-content: center;">Battery capacity</div>
                <div class="configuration-values">{{battery_capacity}}</div>
            </div>
        </div>
    </div>
    <!-- Popup container -->
    <div class="overlay" id="popupOverlay">
        <div class="popup">
            <form method="POST" action="{% url 'update_config' %}">
                {% csrf_token %}
                <div class="house-outside-box">
                    <div class="house-inner-box">
                        Invertor Capacity
                        <select aria-label="Invertor Capacity" class="native-select" name="invertor">
                            <option value="6000">6kw</option>
                            <option value="8000">8kw</option>
                            <option value="12000">12kw</option>
                        </select>
                    </div>
                    <div class="house-inner-box">
                        Instaled solar power
                        <select aria-label="Instaled Solar Power" class="native-select" name="solar">
                            <option value="6000">6kw</option>
                            <option value="8000">8kw</option>
                            <option value="12000">12kw</option>
                        </select>
                    </div>
                    <div class="house-inner-box">
                        Battery capacity
                        <select aria-label="Battery Capacity" class="native-select" name="battery">
                            <option value="5000">5kw</option>
                            <option value="10000">10kw</option>
                            <option value="15000">15kw</option>
                        </select>
                    </div>
                    <button type="submit" id="create-conf-button">Save</button>
                </div>
                <button type="button" class="close-btn" id="closePopup">Close</button>
            </div>
        </form>
    </div>
    <script>
        // Pass Django URLs to JavaScript
        window.DJANGO_URLS = {
            load_status: "{% url 'load_status' %}",
            get_slider_value: "{% url 'get_slider_value' %}",
            gridStatus: "{% url 'gridStatus' %}",
            grid_update: "{% url 'grid-update' %}",
            save_solar: "{% url 'save-solar' %}",
            update_solar: "{% url 'update-solar' %}",
            battery_charge: "{% url 'battery-charge' %}",
        };

        // Pass dynamic Django data to JavaScript
        window.DJANGO_DATA = {
            gridText: "{{grid_text}}",
            gridColor: "{{color}}",
            gridNumber: "{{grid_output}}",
            gridAnimation: "{{grid_animation}}",
            solarAnimation: "{{solar_animation}}",
            solarSliderValue: "{{solar_slider}}",
            loadAnimation: "{{load_animation}}",
            batteryChargeOnOff: "{{battery_charge}}",
            batteryDischargeOnOff: "{{battery_discharge}}",
        };
    </script>

    <script src="{% static 'project1/scripts/solar.js' %}"></script>

</body>
</html>